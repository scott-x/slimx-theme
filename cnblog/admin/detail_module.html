<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="/statics/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/statics/iconfont/iconfont.css">
    <link rel="stylesheet" type="text/css" href="/statics/css/reset.css">
    <link rel="stylesheet" href="/statics/css/custom-pagination.min.css" /><!-- 1.引入css -->
    <link rel="stylesheet" type="text/css" href="/statics/css/modal.r.css">
    <link rel="stylesheet" type="text/css" href="/statics/css/modal_m.css">

    <link rel="stylesheet" type="text/css" href="/statics/css/admin.css">
    <link rel="stylesheet" type="text/css" href="/statics/css/admin_module.css">
    <title>{{ .Title }}</title>
    <script src="/statics/js/jquery-3.5.0.min.js"></script>
    <script src="/statics/js/modal_final.js"></script>
    <script type="text/javascript" src="/statics/js/custom-pagination.min.js"></script><!-- 3.引入js -->
    <script type="text/javascript" src="/statics/bootstrap/js/bootstrap.min.js"></script>
</head>
<body>
<!-- header begin -->
<div class="header">
    <div class="title"></div>
    <div class="avator"></div>
    <div class="logout">
        <ul>
            <li class="exit">退出</li>
        </ul>
    </div>
</div>
<!-- header end -->

<!-- left begin -->
<div class="left">
    <ul>
        <li>
            <a href="/admin">
                <span class="iconfont icon-yibiaopan"></span>
                <span>仪表盘</span>
            </a>
        </li>
        <li >
            <a href="/admin/write">
                <span class="iconfont icon-write"></span>
                <span >写文章</span>
            </a>
        </li>
        <li>
            <a href="/admin/tags">
                <span class="iconfont icon-addphoto_icon_biaoqian_normal"></span>
                <span>标签管理</span>
            </a>
        </li>
        <li>
            <a href="/admin/articles">
                <span class="iconfont icon-to-do"></span>
                <span>文章管理</span>
            </a>
        </li>
        <li class="active">
            <a href="/admin/de_module">
                <span class="iconfont icon-mokuai"></span>
                <span class="active">模块设置</span>
            </a>
        </li>
        <li >
            <a href="/admin/photo">
                <span class="iconfont icon-photo"></span>
                <span >图片收藏</span>
            </a>
        </li>
        <li>
            <a href="/admin/setting">
                <span class="iconfont icon-setting1"></span>
                <span>系统设置</span>
            </a>
        </li>
    </ul>
</div>
<!-- left end -->
<!-- modal start -->
 
<div class="modal fade" tabindex="-1" role="dialog" id="myModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">添加模块</h4>
      </div>
      <div class="modal-body">
         模块名:<input type="text" name="" id ="module_name" style="outline: none;border: 1px solid #ccc;padding: 2px 5px;border-radius: 5px;color: #565655;">
         &nbsp;&nbsp;&nbsp;&nbsp;模块类型: <select id="mySelect">
                  </select>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary">确认</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!-- modal end -->
<!-- right begin -->
<div class="right">
    <div class="nav">
        admin/模块管理(前端详情页) <div class="myAdd"><span class="iconfont icon-add" id="modal-btn"></span>
        </div>
        <div class="admin-module">
            <div class="head">
                <span class="iconfont icon-gengduo6">&nbsp;模块</span>&nbsp;<span class="iconfont icon-entypodownopenmini"></span>
            </div>
            <div class="body">
            
            </div>
        </div>
    </div>
    <!-- right end -->
    <script type="text/javascript">
        $(function(){
            $.get("/api/detail/modules",{},function(data){
                var modules = data.modules
                var dom =""
                for (var i = 0; i < modules.length; i++) {
                    dom += `
                    <div class="item" style="opacity:${modules[i].visiable==1?1:0.9}">
                       <div class="action">
                           <span class="iconfont icon-gengduo3"></span>
                       </div>
                       <img src="${modules[i].cover}">
                       <p>${modules[i].type_name}</p>
                       <div>
                           <span class="status ${modules[i].visiable==1?'active':''}"></span>
                           <h4>${modules[i].title}</h4>
                       </div>
                    </div>   
                    `
                }
                $(".admin-module .body").html(dom)
                $(".admin-module .body .item").mouseenter(function(){
                    $(this).find(".action").show()
                    $(this).siblings().find(".action").hide()
                })

                $(".admin-module .body .item").mouseleave(function(){
                     $(this).find(".action").hide()
                })
            })

            $("#modal-btn").click(function(){
                $("#myModal").modal("show")
                
                $.get("/api/detail/module",{},function(data){
                    var dom = ''
                    var modules = data.module_types
                    console.log(modules)
                    for (var i = 0; i < modules.length; i++) {
                        dom += `
                       <option id='${modules[i].id}'>${modules[i].zh}</option>
                    `
                    }
                    $("#mySelect").html(dom)
                    $(".btn-primary").click(function(){
                        var title = $("#module_name").val()
                        var type = $("#mySelect").val()
                        var id
                        if (type=="轮播图") {
                            id =1
                        }else if (type=="纯文本链接类型"){
                            id =2
                        }else {
                            id =3
                        }
                        //insert a module
                        $.post("/api/detail/new_module",{
                            title:title,
                            T:id
                        },function(data){
                            // alert(data.msg)
                        })
                         $("#myModal").modal("hide")
                         window.location.href = "/admin/de_module"
                    })
                })                
            })
        })
    </script>
    <script src="/statics/js/admin.js"></script>
</body>
</html>